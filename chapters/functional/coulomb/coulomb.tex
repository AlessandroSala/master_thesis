\section{Coulomb interaction}
In the Slater approximation \cite{SlaterApp}, the Coulomb energy contribution to the total energy is
\begin{align}
    E_\text{Coul} = \int \mathcal E_\text{Coul}(\mathbf r) d\bm r
    \\\mathcal E_\text{Coul}(\bm r) = \frac{e^2}{2}\bigg[\int  \frac{\rho_p(\mathbf r )\rho_p(\mathbf r ' )}{|\mathbf r-\mathbf r'|}d\mathbf r'  - \frac 3 2 \bigg(\frac 3 \pi \bigg) ^{\frac 1 3}\rho_p^{4/3}(\mathbf r)\bigg]
\end{align}
Which gives
\begin{equation}
    U_{C}(\mathbf r) = \fdv{\mathcal E_\text{Coul}}{\rho_p} = \frac{e^2}{2}\bigg[\int \frac{\rho_p(\mathbf r ')}{|\mathbf r-\mathbf r'|} d^3 \mathbf r' - 2\bigg(\frac 3 \pi \bigg) ^{\frac 1 3} \rho_p^{1/3}(\mathbf r ) \bigg]
\end{equation}
The direct contribution is what one would get classically, computing the energy of a charge distribution.
\\The exchange part, arising from fermionic nature of nucleons, would be non-local, hence the need for a practical and robust approximation.
\\From a computational standpoint, the exchange part is trivial, while the direct one is more involved.
One could compute the integral, but the complexity on a 3D mesh is $\mathcal O(N^6)$, rendering it unusable for fine meshes.
\\An alternative approach is to solve the poisson equation (from now on, $V_c$ refers to the direct part only)
\begin{equation}
    \nabla^2 V_c = 4\pi e^2 \rho_p
\end{equation}
The boundary conditions are of Dirichlet type, which can be extracted from a quadrupole expansion of the charge density \cite{Jackson1998}
\begin{equation}
V_c (\mathbf r) = 4\pi e^2 \sum_{\lambda=0}^2\sum_{\mu=-\lambda}^\lambda \frac{\expval{Q_{\lambda\mu}} Y_{\lambda\mu}}{r^{1+\lambda}}\text{ on }\partial \Omega
\end{equation}
Where $\expval{Q_{\lambda\mu}}$ is defined as 
\begin{equation}
    \expval{Q_{\lambda\mu}} = \int r^\lambda Y_{\lambda\mu}^* (\mathbf r)\rho_p(\mathbf r ) d^3 \mathbf r
\end{equation}
Since we expect a charge density confined to the nuclear shape, higher order terms in the expansion can be neglected, provided that the box is sufficiently large.
\\In a reference frame where the nucleus center of mass is at the origin, the expansion reduces to
\begin{equation}
    V_{c}(\mathbf r ) = \frac{Ze^2}{r} + e^2\sum_{\mu=-2}^{2}\frac{\expval{Q_{2\mu}}Y_{2\mu}}{r^3} \text{ on } \partial \Omega
\end{equation}
Refer to appendix \ref{sec:spherical_harmonics} for the definition and numerical evaluation of the spherical harmonics $Y_{\lambda\mu}$.
\subsubsection{Imposing the boundary conditions}
The high order discretization stencil of the laplacian, like in our case, involves points with a distance up to $\pm 2$, this means that the quadrupole expanded potential must be calculated on a box bigger than the one used.
Without losing generality, we can look at how boundary conditions are set in 1D. The 3D case follows trivially.
\\The linear system of equations in the 5 points finite difference scheme, explained in (REF),will look like
\[
\begin{bmatrix}
    c_{0,0} & \ldots & c_{0,N-1} \\
    \vdots & \ddots & \vdots \\
    c_{N-1,0} & \ldots & c_{N-1,N-1}
\end{bmatrix}
\begin{bmatrix}
    V_0 \\ \vdots \\ V_{N-1}
\end{bmatrix}
=
4\pi e^2
\begin{bmatrix}
    \rho_0 \\ \vdots \\ \rho_{N-1}
\end{bmatrix}
\]
Near a boundary, say $i=0$, the stencil has the form
\begin{equation}
    c_{0,-2}V_{-2} + c_{0,-1}V_{0,-1} + c_{0,0}V_0 + c_{0,1}V_1 + c_{0,2}V_2 = 4\pi e^2 \rho_0
\end{equation}
The $C$ matrix only accounts for points inside the box, namely $i=0, 1, 2$ we can take advantage of this and bring the "missing" terms on the right side of the equation, calculated from the multipole expansion.
\[
c_{0,0} V_0 + c_{0,1} V_1 + c_{0,2} V_2 = 4\pi e^2 \rho_0 - c_{0,-2}V_{-2} - c_{0,-1}V_{-1}
\]
\\This forces the linear system to always abide by the boundary conditions.
\\This same procedure must be applied to every equation involving points outside the box, e.g. for $i=1$
\[
c_{1,0} V_0 + c_{1,1} V_1 + c_{1,2} V_2 + c_{1,3} V_3 = 4\pi e^2 \rho_1 - c_{1,-1}V_{-1} 
\]
After imposing the boundary conditions, we can easily solve the linear system of equations.
